# Методологическое Руководство: Платформа Surgery-Onko-SSV

## 1. Цель и Область Применения

Цель этого документа — предоставить стандартную методологию для разработки, валидации и клинического применения моделей машинного обучения (ML), создаваемых в рамках платформы `Platform-Surgery-Onko-SSV`. Основной фокус — предсказание исходов гастрэктомии при раке желудка с использованием клинических, молекулярно-генетических и хирургических данных.

## 2. Стадия Демонстрации vs. Клиническое Исследование

**⚠️ ТЕКУЩАЯ ВЕРСИЯ ПЛАТФОРМЫ:** Является **демонстрацией концепции (proof-of-concept)**. Она использует **синтетические данные** (`data/gastrectomy_patients.json`) для проверки работоспособности ML-пайплайна и API.

**Настоящее методологическое руководство:** Описывает **план перехода к клиническому исследованию**, который будет реализован после интеграции с реальной клинической базой данных.

## 3. План Исследования на Реальных Данных

### 3.1. Гипотеза

Комбинация клинических, хирургических и потенциально молекулярно-генетических факторов может быть эффективно использована нейросетевыми моделями для прогнозирования вероятности постоперационных осложнений и выживаемости пациентов после радикальной гастрэктомии при аденокарциноме желудка.

### 3.2. Критерии Включения и Исключения

**Включение:**
- Подтвержденный диагноз аденокарциномы желудка (гистологически)
- Плановая радикальная гастрэктомия (тотальная или субтотальная) с лимфаденэктомией D1/D2
- Полные архивы медицинской документации, включая дооперационные данные, протокол операции, гистологию, данные наблюдения

**Исключение:**
- Экстренная хирургия
- Паллиативные операции
- Неполные данные, не позволяющие однозначно определить исход

### 3.3. Сбор Данных

- **Источник:** Клиническая база данных Института общей и неотложной хирургии им. В.Т. Зайцева НАМН Украины
- **Ответственность:** Сбор данных осуществляется курирующим отделением неотложной хирургии, под руководством профессора, зам. директора по науке
- **Анонимизация:** Все данные подвергаются строгой анонимизации в соответствии с внутренними этическими нормами и законодательством о защите персональных данных. Идентифицирующие данные (ФИО, паспорт и т.д.) не включаются в датасет

### 3.4. Структура Датасета (Предлагаемая)

**Признаки (Features):**
- Демографические: возраст, пол
- Медицинская история: BMI, сопутствующие заболевания (да/нет), статус ECOG/ASA
- Диагностические: стадия опухоли (TNM), локализация, дифференцировка по гистологии, результаты биомаркеров (HER2, MSI, PD-L1)
- Хирургические: тип операции (открытая/лапароскопическая), объем резекции, время операции, объем кровопотери, количество удаленных лимфоузлов, осложнения IntraOp (да/нет)
- Постоперационные данные: осложнения (Clavien-Dindo), продолжительность госпитализации, статус послеоперационной химиотерапии

**Целевая переменная (Target):**
- `complications`: Бинарная (1 - были осложнения, 0 - не было)
- `survival_months`: Числовая (месяцы выживания)
- `status`: Категориальная (alive, deceased)

### 3.5. Обработка и Предобработка Данных

- **Очистка:** Удаление дубликатов, обработка пропущенных значений (стратегия зависит от признака)
- **Кодирование:** Категориальные переменные кодируются (например, one-hot encoding)
- **Нормализация:** Числовые признаки нормализуются (например, Z-score)

### 3.6. Разработка и Валидация Модели

- **Разделение данных:** Датасет делится на обучающую, валидационную и тестовую выборки (например, 70/15/15)
- **Архитектура:** Используются нейросетевые архитектуры (например, DNN, как в `scripts/train_gastrectomy_model.js`), адаптированные под размер и структуру реального датасета
- **Метрики:** Для задачи классификации осложнений: AUC-ROC, Accuracy, Precision, Recall, F1-Score. Для задачи регрессии выживаемости: MAE, RMSE
- **Кросс-валидация:** Проводится K-fold кросс-валидация на обучающей выборке для оценки устойчивости модели
- **Валидация:** Финальная модель тестируется на независимой тестовой выборке

### 3.7. Этические Соображения

- Исследование не требует дополнительного информированного согласия, так как использует анонимизированные данные, собранные в рамках стандартного клинического протокола
- Исследование будет зарегистрировано во внутреннем реестре исследований института

## 4. Дальнейшие Шаги

1. Интеграция с реальной базой данных
2. Реализация пайплайна сбора и предобработки данных
3. Обучение и валидация модели на реальных данных
4. Подготовка научной публикации

## 5. Безопасность и Защита Данных

- API защищен с помощью `helmet` middleware для безопасности HTTP-заголовков
- Реализована Bearer token аутентификация через переменную окружения `API_TOKEN`
- Все защищенные эндпоинты требуют валидный токен доступа
- Валидация входящих данных обязательна для всех POST/PUT запросов

## 6. Ссылки и Ресурсы

- CONSORT Guidelines: http://www.consort-statement.org/
- TRIPOD Statement: https://www.tripod-statement.org/
- STROBE Guidelines: https://www.strobe-statement.org/
